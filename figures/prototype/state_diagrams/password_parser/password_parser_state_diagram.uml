@startuml
!theme plain

skin rose

title Password Parser

state RUNNING {
IDLE:Pending password
STOP:Stop delimiter byte reached.\nAwaiting password start delimiter byte.
START:
ESPACE:Store escape bytes
DATA:Store password bytes.
  IDLE <- IDLE: else
  IDLE ---> START:if data_in = start delimiter byte
  STOP --> START: if data_in = start delimiter byte
  STOP <- STOP: else
  START --> DATA
  ESPACE -> DATA
  DATA -u-> ESPACE: if data_in = escape bytes 
  DATA -u-> STOP: elsif data_in = stop delimiter byte
  DATA <-u- DATA: else
}
[*] --> IDLE

RESET:
RUNNING -l-> RESET: if reset = 1
RESET -l-> IDLE
@enduml